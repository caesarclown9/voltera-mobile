# –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –í–û–ü–†–û–°–´ –î–õ–Ø –£–¢–û–ß–ù–ï–ù–ò–Ø

## üî¥ –ë–õ–û–ö–ò–†–£–Æ–©–ò–ï –í–û–ü–†–û–°–´ (–±–µ–∑ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å)

### 1. –°—Ö–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

**–¢–µ–∫—É—â–∞—è –ø—É—Ç–∞–Ω–∏—Ü–∞:**
- –í –∫–æ–¥–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ Supabase —Ç–∞–±–ª–∏—Ü–µ `clients`
- –í –æ—Ç–≤–µ—Ç–∞—Ö API: –∫–ª–∏–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ OCPP —Å–µ—Ä–≤–µ—Ä–µ —Å –ø–æ–ª—è–º–∏ (id, name, phone, balance, status)
- Supabase Auth –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –Ω–æ –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞?

**–í–û–ü–†–û–°–´:**
1. –ì–¥–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –∫–ª–∏–µ–Ω—Ç–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏?
   - [ ] –í Supabase —Ç–∞–±–ª–∏—Ü–µ `clients`?
   - [ ] –ù–∞ OCPP —Å–µ—Ä–≤–µ—Ä–µ —á–µ—Ä–µ–∑ API?
   - [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ —Å client_id?

2. –ö–∞–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É Supabase –∏ OCPP —Å–µ—Ä–≤–µ—Ä–æ–º?
   - [ ] OCPP —Å–µ—Ä–≤–µ—Ä —á–∏—Ç–∞–µ—Ç –∏–∑ Supabase?
   - [ ] Supabase —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å OCPP?
   - [ ] –ù–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –¥–∞–Ω–Ω—ã–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è?

3. –û—Ç–∫—É–¥–∞ –±—Ä–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å?
   - [ ] GET /api/v1/balance/{client_id} —Å OCPP —Å–µ—Ä–≤–µ—Ä–∞?
   - [ ] –ò–∑ Supabase —Ç–∞–±–ª–∏—Ü—ã `clients`?
   - [ ] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?

### 2. –ü—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ö–∞–∫–æ–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π flow?**

#### –í–∞—Ä–∏–∞–Ω—Ç A (—á–µ—Ä–µ–∑ Supabase):
```typescript
1. supabase.auth.signUp({ email, password })
2. –ü–æ–ª—É—á–∞–µ–º user.id
3. –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å –≤ Supabase clients —Ç–∞–±–ª–∏—Ü–µ
4. OCPP —Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–∑–Ω–∞–µ—Ç –æ –Ω–æ–≤–æ–º –∫–ª–∏–µ–Ω—Ç–µ?
```

#### –í–∞—Ä–∏–∞–Ω—Ç B (—á–µ—Ä–µ–∑ OCPP API):
```typescript
1. supabase.auth.signUp({ email, password })
2. –ü–æ–ª—É—á–∞–µ–º user.id
3. POST /api/v1/clients/register —Å –¥–∞–Ω–Ω—ã–º–∏?
4. OCPP —Å–µ—Ä–≤–µ—Ä —Å–æ–∑–¥–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞
```

#### –í–∞—Ä–∏–∞–Ω—Ç C (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):
```typescript
1. supabase.auth.signUp({ email, password })
2. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ —Å client_id OCPP —Å–æ–∑–¥–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?
```

### 3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü Supabase

**–ö–∞–∫–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è?**

```sql
-- –≠—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã —Ç–æ—á–Ω–æ –µ—Å—Ç—å?
clients (id, email, phone, name, balance, ...)
charging_sessions (id, user_id, station_id, ...)
payment_transactions_odengi (id, client_id, amount, ...)

-- –ò–ª–∏ –¥—Ä—É–≥–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞?
```

### 4. –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π

**–í –æ—Ç–≤–µ—Ç–∞—Ö —Å–∫–∞–∑–∞–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Supabase –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏:**

```sql
SELECT * FROM charging_sessions WHERE user_id = ?
SELECT * FROM payment_transactions_odengi WHERE client_id = ?
```

**–í–û–ü–†–û–°–´:**
1. `user_id` –≤ charging_sessions —ç—Ç–æ —Ç–æ—Ç –∂–µ `client_id`?
2. –ö—Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —ç—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã?
   - [ ] OCPP —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ Supabase Admin API?
   - [ ] Triggers –≤ Supabase?
   - [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–∞–º–æ –¥–æ–ª–∂–Ω–æ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å?

### 5. –ü–æ–ª—É—á–µ–Ω–∏–µ client_id

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
const { user } = await supabase.auth.signIn(...)
const client_id = user.id // UUID –æ—Ç Supabase Auth
```

**–≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ?**
- [ ] –î–∞, client_id = Supabase Auth User ID
- [ ] –ù–µ—Ç, client_id –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ
- [ ] client_id –±–µ—Ä–µ—Ç—Å—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã clients

### 6. –¢–µ—Å—Ç–æ–≤—ã–µ credentials –¥–ª—è Supabase

**–ù—É–∂–Ω—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
```env
VITE_SUPABASE_URL=?
VITE_SUPABASE_ANON_KEY=?

# –¢–µ—Å—Ç–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç
TEST_EMAIL=?
TEST_PASSWORD=?
TEST_CLIENT_ID=?
```

## üìù –ß–¢–û –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨ –ü–û–°–õ–ï –ü–û–õ–£–ß–ï–ù–ò–Ø –û–¢–í–ï–¢–û–í

1. **–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç—ã –≤ Supabase:**
   - –û—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π –∫–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ clients
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å RLS –ø—Ä–∞–≤–∏–ª–∞
   - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å OCPP

2. **–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç—ã —Ç–æ–ª—å–∫–æ –Ω–∞ OCPP:**
   - –£–¥–∞–ª–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –≤ Supabase
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å endpoint —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ client_id –æ—Ç Auth

3. **–ï—Å–ª–∏ –≥–∏–±—Ä–∏–¥–Ω–∞—è —Å—Ö–µ–º–∞:**
   - –ü–æ–Ω—è—Ç—å —á—Ç–æ –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
   - –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è

## ‚ö†Ô∏è –†–ò–°–ö–ò –ë–ï–ó –£–¢–û–ß–ù–ï–ù–ò–Ø

1. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** - –∫–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏ –≤ Supabase –∏ –Ω–∞ OCPP
2. **–†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±–∞–ª–∞–Ω—Å–∞** - —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö
3. **–ü–æ—Ç–µ—Ä—è –∏—Å—Ç–æ—Ä–∏–∏** - –∑–∞–ø–∏—Å–∏ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –Ω—É–∂–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
4. **–û—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏** - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π client_id
5. **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞—Ä—è–¥–∫–∏** - OCPP –Ω–µ –∑–Ω–∞–µ—Ç –æ –∫–ª–∏–µ–Ω—Ç–µ

---

**–ö–†–ò–¢–ò–ß–ù–û:** –ë–µ–∑ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ —ç—Ç–∏ –≤–æ–ø—Ä–æ—Å—ã –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é!

**–î–∞—Ç–∞**: 2025-09-29