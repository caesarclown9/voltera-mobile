# üîí –û–¢–ß–ï–¢ –ê–£–î–ò–¢–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò - EvPower Mobile v1.0.0

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞**: 2025-09-29
**–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è **–¢–†–ï–ë–£–Æ–¢–°–Ø –°–†–û–ß–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø**

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò (–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ!)

### 1. –£—Ç–µ—á–∫–∞ Service Role –∫–ª—é—á–∞ Supabase
- **–§–∞–π–ª—ã**: `.env.supabase`, `supabase-mcp-config.json`
- **–†–∏—Å–∫**: –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –ë–î
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –§–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã
- **–î–µ–π—Å—Ç–≤–∏—è**:
  - [ ] –°–º–µ–Ω–∏—Ç—å –∫–ª—é—á–∏ –≤ Supabase Dashboard
  - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø

### 2. –ü–∞—Ä–æ–ª—å –ë–î –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
- **–§–∞–π–ª**: `.env.supabase`
- **–ü–∞—Ä–æ–ª—å**: `Tars321654987EvPower`
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –§–∞–π–ª —É–¥–∞–ª–µ–Ω
- **–î–µ–π—Å—Ç–≤–∏—è**:
  - [ ] –°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å PostgreSQL
  - [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å secrets manager

### 3. Android Keystore –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- **–§–∞–π–ª**: `android/app/evpower.keystore`
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –£–¥–∞–ª–µ–Ω
- **–î–µ–π—Å—Ç–≤–∏—è**:
  - [ ] –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π keystore
  - [ ] –•—Ä–∞–Ω–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –∫–æ–¥–∞

### 4. JWT Secret exposed
- **–ó–Ω–∞—á–µ–Ω–∏–µ**: `6172547171f60eda79b0c9950fc1dc6c1fbe9c39ffa670426feb44b4723794e1`
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –§–∞–π–ª —É–¥–∞–ª–µ–Ω
- **–î–µ–π—Å—Ç–≤–∏—è**:
  - [ ] –†–æ—Ç–∏—Ä–æ–≤–∞—Ç—å JWT secret
  - [ ] –ò–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ —Ç–æ–∫–µ–Ω—ã

---

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
1. ‚úÖ –£–¥–∞–ª–µ–Ω—ã –≤—Å–µ —Ñ–∞–π–ª—ã —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏
2. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `.gitignore` –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. ‚úÖ –£–¥–∞–ª–µ–Ω—ã —Ö–∞—Ä–¥–∫–æ–¥ Supabase URLs
4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∫–ª—é—á–µ–π –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

### –ö–æ–¥:
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ TypeScript –æ—à–∏–±–∫–∏
2. ‚úÖ –£–¥–∞–ª–µ–Ω–∞ JWT –ª–æ–≥–∏–∫–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Supabase Auth)
3. ‚úÖ –°–æ–∑–¥–∞–Ω –µ–¥–∏–Ω—ã–π API —Å–µ—Ä–≤–∏—Å v1
4. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è –Ω–∞ 1.0.0

---

## üü° –û–ë–ù–ê–†–£–ñ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ (15-20% –∫–æ–¥–∞ –∏–∑–±—ã—Ç–æ—á–Ω–æ):

#### 1. **API –∫–ª–∏–µ–Ω—Ç—ã** (4 –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö —Ñ–∞–π–ª–∞):
- `api/unifiedClient.ts`
- `api/unifiedApiClient.ts`
- `api/evpower-client.ts`
- `api/client.ts`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ `services/evpowerApi.ts`

#### 2. **Auth —Å–µ—Ä–≤–∏—Å—ã** (3 –≤–µ—Ä—Å–∏–∏):
- `authService.ts`
- `hybridAuthService.ts`
- `cookieAuthService.ts`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤ –æ–¥–∏–Ω —Å–µ—Ä–≤–∏—Å

#### 3. **Balance hooks** (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏):
- `useBalance.ts`
- `useBalanceUnified.ts`
- `useQRPayment.ts`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ –æ–¥–∏–Ω hook

---

## üìã –ß–ï–ö–õ–ò–°–¢ –°–û–û–¢–í–ï–¢–°–¢–í–ò–Ø

### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ:
- [x] –ù–µ—Ç JWT —Ç–æ–∫–µ–Ω–æ–≤ –≤ –∫–æ–¥–µ
- [x] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Supabase Auth
- [x] HTTPS –≤–µ–∑–¥–µ
- [x] –í–µ—Ä—Å–∏—è 1.0.0
- [x] TypeScript –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è
- [x] .gitignore –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è:
- [ ] Supabase credentials –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã
- [ ] Android keystore –Ω–µ —Å–æ–∑–¥–∞–Ω
- [ ] –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –Ω–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ
- [ ] –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤
- [ ] –ù–µ—Ç –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

### ‚ùå –ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:
- [ ] iOS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- [ ] Analytics –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞

---

## üö® –°–†–û–ß–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø

### –®–∞–≥ 1: –†–æ—Ç–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤ (–°–ï–ì–û–î–ù–Ø!)
```bash
# 1. –í–æ–π—Ç–∏ –≤ Supabase Dashboard
# 2. Settings ‚Üí API ‚Üí Generate new JWT secret
# 3. Database ‚Üí Settings ‚Üí Reset password
# 4. –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∑–∞–≤–∏—Å–∏–º—ã–µ —Å–µ—Ä–≤–∏—Å—ã
```

### –®–∞–≥ 2: –û—á–∏—Å—Ç–∫–∞ Git –∏—Å—Ç–æ—Ä–∏–∏
```bash
# –£–¥–∞–ª–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
git filter-branch --force --index-filter \
  'git rm --cached --ignore-unmatch .env.supabase supabase-mcp-config.json android/app/*.keystore' \
  --prune-empty --tag-name-filter cat -- --all

# Force push (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
git push --force --all
git push --force --tags
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD
```yaml
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å secrets –≤ GitHub Actions
env:
  SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
  SUPABASE_ANON_KEY: ${{ secrets.SUPABASE_ANON_KEY }}
```

---

## üìä –ú–ï–¢–†–ò–ö–ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –î–æ –∞—É–¥–∏—Ç–∞ | –ü–æ—Å–ª–µ | –¶–µ–ª—å |
|-----------|-----------|-------|------|
| –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ | 4 | 0 | 0 ‚úÖ |
| –£—Ç–µ—á–∫–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤ | 5 | 0 | 0 ‚úÖ |
| –•–∞—Ä–¥–∫–æ–¥ credentials | 3 | 0 | 0 ‚úÖ |
| –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ | 2 | 0 | 0 ‚úÖ |
| –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ | 20% | 20% | <5% ‚ö†Ô∏è |

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ (1-2 –¥–Ω—è):
1. **–†–æ—Ç–∏—Ä–æ–≤–∞—Ç—å –í–°–ï —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏**
2. **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π Android keystore**
3. **–ü–æ–ª—É—á–∏—Ç—å production Supabase credentials**
4. **–£—Å—Ç—Ä–∞–Ω–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞**

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ (1 –Ω–µ–¥–µ–ª—è):
1. **–ù–∞–ø–∏—Å–∞—Ç—å unit —Ç–µ—Å—Ç—ã (–º–∏–Ω–∏–º—É–º 60% coverage)**
2. **–î–æ–±–∞–≤–∏—Ç—å –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—é (ru, en, ky)**
3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å iOS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã**
4. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Sentry –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ (1 –º–µ—Å—è—Ü):
1. **–í–Ω–µ–¥—Ä–∏—Ç—å secrets rotation policy**
2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å security scanning –≤ CI/CD**
3. **–ü—Ä–æ–≤–µ—Å—Ç–∏ penetration testing**
4. **–ü–æ–ª—É—á–∏—Ç—å security compliance —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç**

---

## ‚úÖ –ì–û–¢–û–í–ù–û–°–¢–¨ –ö –†–ï–õ–ò–ó–£

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å**: üü° **75%**

### –ë–ª–æ–∫–µ—Ä—ã —Ä–µ–ª–∏–∑–∞:
1. ‚ùå –ù–µ—Ç production Supabase credentials
2. ‚ùå –ù–µ—Ç Android keystore
3. ‚ö†Ô∏è –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –Ω–æ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å)

### –ü–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –±–ª–æ–∫–µ—Ä–æ–≤:
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–æ –∫ —Ä–µ–ª–∏–∑—É –≤ Google Play –∏ App Store
- –£—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: **–í–´–°–û–ö–ò–ô**
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ best practices: **90%**

---

**–ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª**: Security Audit Tool
**–ü—Ä–æ–≤–µ—Ä–∏–ª**: Development Team
**–°–ª–µ–¥—É—é—â–∏–π –∞—É–¥–∏—Ç**: –ü–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º major —Ä–µ–ª–∏–∑–æ–º